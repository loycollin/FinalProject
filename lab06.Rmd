---
title: "FinalProject_Start"
author: "Michelle Cryder, Collin Loy"
date: "November 28, 2018"
output: html_document
---

# Introduction
  * This dataset includes the names and characterics of olympic athletes from 1896-2016. Variables include personal statistics, (such as age, gender, height, and weight of each athlete), along with the sport, country, and medals received. There is another dataset that provides the National Olympic Committee code (NOC) and the corresponding geographical region. Source information about the dataset: https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results/home
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(gtable)
library(grid)

athletes = read_csv("https://raw.githubusercontent.com/loycollin/FinalProject/master/athlete_events.csv")     #import athlete data 
regions = read_csv("https://raw.githubusercontent.com/loycollin/FinalProject/master/noc_regions.csv")         #import region data

olympics = left_join(athletes, regions, by = "NOC")   #join athletes and region data by NOC 
```

# Data Exploration 

```{r}
str(olympics)

summary(olympics)

# Summarize Gender:
olympics %>% group_by(region, Sex) %>% count() 
olympics %>% ggplot(aes(x = Sex, fill = Sex)) + geom_bar()

# Summarize Age: 
olympics %>% ggplot(aes(x = Age)) + geom_bar()
olympics %>% group_by(region) %>% summarise(mean_age = mean(Age, na.rm=TRUE)) 
olympics %>% group_by(region) %>% summarise(mean_age = mean(Age, na.rm=TRUE)) %>% ggplot(aes(mean_age)) + geom_histogram(binwidth = 0.25)

# Summarize Height: 
olympics %>% ggplot(aes(x = Height)) + geom_bar() + xlab("Height (cm)")
olympics %>% group_by(region) %>% summarise(mean_height = mean(Height, na.rm=TRUE))

# Summarize Weight: 
olympics %>% ggplot(aes(Weight)) + geom_histogram() + xlab("Weight (kg)")
olympics %>% group_by(region) %>% summarise(mean_weight = mean(Weight, na.rm=TRUE))

# Summarize Regions: 
olympics %>% group_by(region) %>% count() 
names = olympics %>% group_by(Name) %>% select(Name, region) 

# Summarize medals: 
olympics %>% group_by(region, Medal) %>% count() %>% ggplot(aes(n)) + geom_histogram()

```                                                                                   
                                                                                           
                                                                                           
# Expanding complexity

```{r}
###  Investigate two-way relationships 
  
# Scatterplots for two numeric variables: numeric vs numeric

    # Athlete Height vs Weight 
olympics %>% ggplot(aes(x = Height, y = Weight)) + geom_jitter(colour = "navy", size = 0.5) + ylab("Weight (kg)")

    # Athlete Age vs Height 
olympics %>% ggplot(aes(x = Age, y = Height)) + geom_jitter(colour = "red", size = 0.1) + ylab("Height (cm)")

    # Athlete Avg vs Weight
olympics %>% ggplot(aes(x = Age, y = Weight)) + geom_jitter(colour = "red", size = 0.1) + ylab("Weight (kg)")

# Side-by-side boxplots or facetted polots for numeric/categorical pair: numeric vs. categorical 

    # Female vs Male athletes by year for summer olympics 
olympics %>% filter(Season == "Summer") %>%  group_by(Year, Sex) %>% count() %>% ggplot(aes(x = Year, y = n, colour = Sex)) + geom_point() + geom_line()

    # Female vs Male athletes by year for winter olympics
olympics %>% filter(Season == "Winter") %>%  group_by(Year, Sex) %>% count() %>% ggplot(aes(x = Year, y = n, colour = Sex)) + geom_point() + geom_line()

    # Age vs number of medals 
medals = olympics %>% filter(Medal == c("Gold", "Silver", "Bronze"))
medals_age = medals %>% group_by(Age, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n)

medals_age %>% ggplot(aes(x = Age, y = Num_Medals, colour = Medal)) + geom_point() + scale_color_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Number of Medals")
medals_age %>% ggplot(aes(x = Age, y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Number of Medals")

    # Number of medals per country
medals_country = medals %>% group_by(region, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n) %>% arrange(desc(Num_Medals), Medal)
```
```{r echo = FALSE, fig.width=16, fig.height=15}
    # All Regions
na.omit(medals_country) %>% ggplot(aes(reorder(region, Num_Medals), y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + coord_flip() + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Number of Medals")
```

# A closer look at the top 5
  Interesting Insights
    + France seems to show that Women have never won gold ion an event twice.

```{r}
### Investigating Medals and Games
    
    # Top 5 Countries
medals_country %>%  filter(region %in% c("USA", "Russia", "Germany", "UK", "France")) %>% ggplot(aes(x = region, y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + coord_flip() + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab"))
    
    # Region Medals per Event
event_medals = medals %>% group_by(region, Event, Sex, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n) %>% arrange(desc(Num_Medals), Medal)

#USA

    # Top 10 Medal Events US
      # Mens
US_MensG = event_medals %>% filter(region %in% c("USA"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_MensG = ggplotGrob(US_MensG)

US_MensS = event_medals %>% filter(region %in% c("USA"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("USA Mens")
US_MensS = ggplotGrob(US_MensS)

US_MensB = event_medals %>% filter(region %in% c("USA"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_MensB = ggplotGrob(US_MensB)

      # Womens
US_WomensG = event_medals %>% filter(region %in% c("USA"), Medal == "Gold", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_WomensG = ggplotGrob(US_WomensG)

US_WomensS = event_medals %>% filter(region %in% c("USA"), Medal == "Silver", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("USA Womens")
US_WomensS = ggplotGrob(US_WomensS)

US_WomensB = event_medals %>% filter(region %in% c("USA"), Medal == "Bronze", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_WomensB = ggplotGrob(US_WomensB)

    #grid arrangement
US_Mens = cbind(US_MensG, US_MensS, US_MensB, size = "first" )
US_Womens = cbind(US_WomensG, US_WomensS, US_WomensB, size = "first" )
grid.draw(US_Mens)
grid.newpage()
grid.draw(US_Womens)
grid.newpage()

    # Atheletes with the Most medals



# Russia

    # Top Ten Gold Medal Events Russia
      # Mens
RU_MensG = event_medals %>% filter(region %in% c("Russia"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
RU_MensG = ggplotGrob(RU_MensG)

RU_MensS = event_medals %>% filter(region %in% c("Russia"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("Russia Mens")
RU_MensS = ggplotGrob(RU_MensS)

RU_MensB = event_medals %>% filter(region %in% c("Russia"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
RU_MensB = ggplotGrob(RU_MensB)

      # Womens
RU_WomensG = event_medals %>% filter(region %in% c("Russia"), Medal == "Gold", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
RU_WomensG = ggplotGrob(RU_WomensG)

RU_WomensS = event_medals %>% filter(region %in% c("Russia"), Medal == "Silver", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("Russia Womens")
RU_WomensS = ggplotGrob(RU_WomensS)

RU_WomensB = event_medals %>% filter(region %in% c("Russia"), Medal == "Bronze", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
RU_WomensB = ggplotGrob(RU_WomensB)

    #grid arrangement
RU_Mens = cbind(RU_MensG, RU_MensS, RU_MensB, size = "first" )
RU_Womens = cbind(RU_WomensG, RU_WomensS, RU_WomensB, size = "first" )
grid.draw(RU_Mens)
grid.newpage()
grid.draw(RU_Womens)
grid.newpage()

# Germany
    #Top Ten Gold Medal Events Germany
      # Mens
GE_MensG = event_medals %>% filter(region %in% c("Germany"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
GE_MensG = ggplotGrob(GE_MensG)

GE_MensS = event_medals %>% filter(region %in% c("Germany"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("Germany Mens")
GE_MensS = ggplotGrob(GE_MensS)

GE_MensB = event_medals %>% filter(region %in% c("Germany"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
GE_MensB = ggplotGrob(GE_MensB)

      # Womens
GE_WomensG = event_medals %>% filter(region %in% c("Germany"), Medal == "Gold", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
GE_WomensG = ggplotGrob(GE_WomensG)

GE_WomensS = event_medals %>% filter(region %in% c("Germany"), Medal == "Silver", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("Germany Womens")
GE_WomensS = ggplotGrob(GE_WomensS)

GE_WomensB = event_medals %>% filter(region %in% c("Germany"), Medal == "Bronze", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
GE_WomensB = ggplotGrob(GE_WomensB)

    #grid arrangement
GE_Mens = cbind(GE_MensG, GE_MensS, GE_MensB, size = "first" )
GE_Womens = cbind(GE_WomensG, GE_WomensS, GE_WomensB, size = "first" )
grid.draw(GE_Mens)
grid.newpage()
grid.draw(GE_Womens)
grid.newpage()


# UK

    # Top Ten Gold Medal Events UK
      # Mens
UK_MensG = event_medals %>% filter(region %in% c("UK"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
UK_MensG = ggplotGrob(UK_MensG)

UK_MensS = event_medals %>% filter(region %in% c("UK"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("UK Mens")
UK_MensS = ggplotGrob(UK_MensS)

UK_MensB = event_medals %>% filter(region %in% c("UK"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
UK_MensB = ggplotGrob(UK_MensB)

      # Womens
UK_WomensG = event_medals %>% filter(region %in% c("UK"), Medal == "Gold", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
UK_WomensG = ggplotGrob(UK_WomensG)

UK_WomensS = event_medals %>% filter(region %in% c("UK"), Medal == "Silver", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("UK Womens")
UK_WomensS = ggplotGrob(UK_WomensS)

UK_WomensB = event_medals %>% filter(region %in% c("UK"), Medal == "Bronze", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
UK_WomensB = ggplotGrob(UK_WomensB)

    #grid arrangement
UK_Mens = cbind(UK_MensG, UK_MensS, UK_MensB, size = "first" )
UK_Womens = cbind(UK_WomensG, UK_WomensS, UK_WomensB, size = "first" )
grid.draw(UK_Mens)
grid.newpage()
grid.draw(UK_Womens)
grid.newpage()

# France
    
    # Top Ten Gold Medal Events France
      # Mens
FR_MensG = event_medals %>% filter(region %in% c("France"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
FR_MensG = ggplotGrob(FR_MensG)

FR_MensS = event_medals %>% filter(region %in% c("France"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("France Mens")
FR_MensS = ggplotGrob(FR_MensS)

FR_MensB = event_medals %>% filter(region %in% c("France"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
FR_MensB = ggplotGrob(FR_MensB)

      # Womens
FR_WomensG = event_medals %>% filter(region %in% c("France"), Medal == "Gold", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
FR_WomensG = ggplotGrob(FR_WomensG)

FR_WomensS = event_medals %>% filter(region %in% c("France"), Medal == "Silver", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("France Womens")
FR_WomensS = ggplotGrob(FR_WomensS)

FR_WomensB = event_medals %>% filter(region %in% c("France"), Medal == "Bronze", Sex == "F") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
FR_WomensB = ggplotGrob(FR_WomensB)

    #grid arrangement
FR_Mens = cbind(FR_MensG, FR_MensS, FR_MensB, size = "first" )
FR_Womens = cbind(FR_WomensG, FR_WomensS, FR_WomensB, size = "first" )
grid.draw(FR_Mens)
grid.newpage()
grid.draw(FR_Womens)
grid.newpage()

```


```{r}
library(maps)

world <- map_data("world")

medals.gold = medals_country %>% filter(Medal %in% "Gold")

map.gold = medals.gold %>% left_join(world, by = "region")

map.gold %>% ggplot() + geom_polygon(aes(x = long, y = lat, group=group, fill = Num_Medals)) + scale_fill_gradient(low = "#f9f383", high = "#e1d607") + geom_path(data = world, aes(x = long, y = lat, group = group), color = "dark grey") + ggtitle("Olympic Gold Medals")


map.medals = medals_country %>% left_join(world, by = "region")

```

```{r, fig.height=5.5, fig.width=20}

map.medals %>% ggplot() + geom_polygon(aes(x = long, y = lat, group=group, fill = Num_Medals)) + geom_path(data = world, aes(x = long, y = lat, group = group), color = "dark grey") + ggtitle("Olympic Medals") + facet_wrap(~Medal)

```



---
title: "Final Project: Olympics"
author: Collin Loy, Michelle Cryder
ratio: 16x10
output:
  rmdshower::shower_presentation:
    self_contained: false
    katex: true
    theme: ribbon
---

## Introduction
  - This dataset includes the names and characterics of olympic athletes from 1896-2016. Source information about the dataset: https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results/home
  
## Prepare the Data
```{r message=FALSE}
library(tidyverse)
library(lubridate)
library(gtable)
library(grid)

athletes = read_csv("https://raw.githubusercontent.com/loycollin/FinalProject/master/athlete_events.csv")     #import athlete data 
regions = read_csv("https://raw.githubusercontent.com/loycollin/FinalProject/master/noc_regions.csv")         #import region data
olympics = left_join(athletes, regions, by = "NOC")                                                           #join athletes and region data by NOC 
```

## Data Exploration
```{r echo=FALSE, message=FALSE}
str(olympics)
```

## Data Exploration
```{r echo=FALSE, message=FALSE}
summary(olympics)
```

## Data Exploration
### **Insights:**
* Year: Data ranges from 1896 - 2016
* Average Weight of competitors is 70.7(kg) or 156.87(lb)
* Average Height of competitors is 175.3(cm) or 5'7"
* Age:
    + Largest Age Group: 23
    + Youngest Age: 10
    + Oldest Age: 97
- Most Throughout the years won within the athletes 20's
- Data shows 196,594 Males and 74,522 Females in total
    + No single year has had more females been at the olympics then males.

## Data Exploration
### **Insights:**
- Top 5 Countries include:
    + USA with 1842 Medals total
    + Russia with 1331 Medals Total
    + Germany with 1243 Medals Total
    + UK with 724 Medals Total
    + France with 597 Medals Total

## Visual Summaries: Variables 
**Gender:**
```{r echo=FALSE, message=FALSE}
olympics %>% ggplot(aes(x = Sex, fill = Sex)) + geom_bar() + ggtitle("Olympic Athletes by Gender") + ylab("Count")
```

## Visual Summaries: Variables 
**Age:**

```{r echo=FALSE, message=FALSE}
olympics %>% group_by(region) %>% summarise(mean_age = mean(Age, na.rm=TRUE)) %>% ggplot(aes(mean_age)) + geom_histogram(binwidth = 0.25) + xlab("Age") + ylab("Count") + ggtitle("Mean Olympic Athlete Age")
```

## Visual Summaries: Variables 
**Height:**

```{r echo=FALSE, message=FALSE, warning=FALSE}
olympics %>% ggplot(aes(x = Height)) + geom_bar() + xlab("Height (cm)") + ylab("Count") + ggtitle("Mean Olympic Athlete Height")
```

## Visual Summaries: Variables 
**Weight:**

```{r echo=FALSE, message=FALSE, warning=FALSE}
olympics %>% ggplot(aes(Weight)) + geom_histogram() + xlab("Weight (kg)") + ylab("Count") + ggtitle("Mean Olympic Athlete Weight")
```

## Expanding complexity
- scatterplots for two numeric variables: numeric vs. numeric

```{r echo=FALSE, message=FALSE, warning=FALSE}
olympics %>% ggplot(aes(x = Height, y = Weight)) + geom_jitter(colour = "navy", size = 0.5) + ylab("Weight (kg)") + xlab("Height (cm)") + ggtitle("Athlete Height vs Weight")
```

## Expanding complexity
- scatterplots for two numeric variables: numeric vs. numeric

```{r echo=FALSE, message=FALSE, warning=FALSE}
olympics %>% ggplot(aes(x = Age, y = Height)) + geom_jitter(colour = "navy", size = 0.1) + ylab("Height (cm)") + ggtitle("Athlete Age vs Height")
```

## Expanding complexity
- scatterplots for two numeric variables: numeric vs. numeric

```{r echo=FALSE, message=FALSE, warning=FALSE}
olympics %>% ggplot(aes(x = Age, y = Weight)) + geom_jitter(colour = "navy", size = 0.1) + ylab("Weight (kg)") + ggtitle("Athlete Age vs Weight")
```

## Expanding complexity

```{r echo=FALSE, message=FALSE, warning=FALSE}
medals = olympics %>% filter(Medal == c("Gold", "Silver", "Bronze"))
medals_age = medals %>% group_by(Age, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n)

medals_age %>% ggplot(aes(x = Age, y = Num_Medals, colour = Medal)) + geom_point() + scale_color_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Medal Count") + ggtitle("Medal Count by Age")
```

## Medal Count
```{r echo=FALSE, message=FALSE, warning=FALSE}
medals_age %>% ggplot(aes(x = Age, y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Medal Count") + ggtitle("Medal Count by Age")
```

## Medals by Country
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=16, fig.height=15}
medals_country = medals %>% group_by(region, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n) %>% arrange(desc(Num_Medals), Medal)
na.omit(medals_country) %>% ggplot(aes(reorder(region, Num_Medals), y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + coord_flip() + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Medal Count") + xlab("") + ggtitle("Medal Count by Country")
```

## Top 5 Countries
```{r echo=FALSE, message=FALSE, warning=FALSE}
medals_country$region = factor(medals_country$region, levels = levels(reorder(medals_country$region, medals_country$Num_Medals, sum, na.rm=TRUE)))
medals_country %>%  filter(region %in% c("USA", "Russia", "Germany", "UK", "France")) %>% ggplot(aes(x = region, y = Num_Medals, fill = Medal)) + geom_bar(stat = "identity") + coord_flip() + scale_fill_manual(values=c("#bf6f40", "#ffbf00", "#bab2ab")) + ylab("Medal Count") + xlab("") + ggtitle("Medal Count: Top 5 Countries")
```

## A closer look at the top 5
### **USA**  
+ Male
    + Best Gold Medal Event: Basketball
    + Best Silver Medal Event: Ice Hockey
    + Best Bronze Medal Event: Water Polo
+ Female
    + Best Gold Medal Event: Tie between Basketball and the Swimming 4 x 100 Meter Medley Relay
    + Best Silver Medal Event: Ice Hockey
    + Best Bronze Medal Event: Gymnastics Team All-Around
    
  
## **USA: Athletes with the Most Gold Medals**
+ Male: Michael Fred Phelps II with 10 Medals Total
    + Comparing Gold medals With top ten Gold Medal country events.
    + Swimming 4 x 200 metres Freestyle Relay: 2 Gold Medals
    + Swimming 4 x 100 metres Freestyle Relay: 1 Gold Medal
+ Female: Jennifer Elisabeth "Jenny" Thompson with 7 Medals Total
    + Her name also appears in the top  Silver Medals graph of US athletes
    + Comparing Gold medals with top ten Gold Medal country events.
        + Swimming 4 x 100 metres Freestyle Relay: 2 Gold
        + Swimming 4 x 100 metres Medley Relay: 1 Gold
        + Swimming Women's 4 x 200 metres Freestyle Relay: 1 Gold
+ *Graphs show that certain athletes appear to be listed as top winners of multiple medal types.*


## **USA: Top 10 Medal Events (Mens)**

```{r echo=FALSE, message=FALSE, warning=FALSE}    
    # Region Medals per Event
event_medals = medals %>% group_by(region, Event, Sex, Medal) %>% count() %>% mutate(Num_Medals = n) %>% select(-n) %>% arrange(desc(Num_Medals), Medal)

#USA

    # Top 10 Medal Events US
      # Mens
US_MensG = event_medals %>% filter(region %in% c("USA"), Medal == "Gold", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Gold Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_MensG = ggplotGrob(US_MensG)

US_MensS = event_medals %>% filter(region %in% c("USA"), Medal == "Silver", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Silver Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle("USA Mens")
US_MensS = ggplotGrob(US_MensS)

US_MensB = event_medals %>% filter(region %in% c("USA"), Medal == "Bronze", Sex == "M") %>% arrange(desc(Num_Medals)) %>% head(10) %>% ggplot(aes(reorder(Event, Num_Medals), y = Num_Medals)) + geom_bar(stat = "identity") + ylab("Bronze Medals") + xlab(" ") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggtitle(" ")
US_MensB = ggplotGrob(US_MensB)   

```



